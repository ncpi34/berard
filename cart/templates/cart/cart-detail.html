{% extends 'website/base.html' %}
{% load static %}

{#{% block title %}#}
{#    Panier#}
{#{% endblock %}#}

{% block content %}
    <main>
    <div class="container">
    <div class="table-responsive text-nowrap">
    <h2 class="text-center mt-3">Votre Panier</h2>
    <!-- {% if cart %} -->
    <table class="table">
        <thead>
        <tr>
            <th scope="col">Image</th>
{#            <th scope="col">Price</th>#}
            <th scope="col">Libellé</th>
            <th scope="col">Prix Unitaire</th>
            <th scope="col">Total</th>
            <th scope="col">Quantité</th>
        </tr>
        </thead>
        <tbody>

        {% for order_item in cart%}
            {% with product=order_item.product %}

        <tr>
{#            <th scope="row">{{ forloop.counter }}</th>#}
                <td>
                    <a href="{{ product.get_absolute_url }}">
                        <img class="img-fluid img-thumbnail w-60"
                             src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Vertical/13.jpg"/>
                    </a>
                </td>
            <td>{{ order_item.libelle }}</td>
            <td class="num">
                <div class="mb-5">{{ order_item.prix_achat }}</div>
                <div><a
{#                        data-id="{% url 'cart:cart_remove' product.id %}"#}
                        href="{% url 'cart:cart_remove' product.id %}"
                   class="delete_article btn btn-danger btn-sm"
                ><i class="far fa-trash-alt"></i></a>
                </div>
            </td>
            <td class="num">{{ order_item.total_price }}</td>
                <td>
                    <form action="{% url 'cart:cart_update' product.id %}" method="post">
                        {{ order_item.update_quantity_form.quantity }}
                        {{ order_item.update_quantity_form.update }}
{#                        <input type="submit" class="btn btn-success btn-sm" value="Ok"/>#}
                        <button type="submit" class="btn btn-warning btn-sm"><i class="fas fa-edit"></i></button>
                        {% csrf_token %}
                    </form>
            </td>


{#                <a href="{% url 'cart:cart_remove' product.id %}"><i class="fas fa-minus mr-2"></i></a>#}
{#                {{ order_item.quantity }}#}
{#                <a href="{% url 'cart:cart_add' product.id %}"><i class="fas fa-plus ml-2"></i></a>#}

            {% endwith %}
            {% endfor %}

        </tr>

        <tr class="total">
            <td>Total</td>
            <td colspan='1'></td>
            <td class="num">{{ cart.get_total_price}}€</td>
        </tr>
        </tbody>
    </table>
         <p class="text-right">
            <button class="btn btn-success">Commander</button>
        </p>

    <!-- {% else %} -->
        <div class="container text-center mt-5" style="min-height: 50vh">
            <h3>Votre panier est vide ...</h3>
        </div>

    <!-- {% endif %} -->
    </div>
    </div>
  </main>
     <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
      <!-- You can alternatively load the minified version -->
      <script src="{% static 'js/jquery.bootstrap.modal.forms.js' %}"></script>
    <script>
    $(document).ready(function() {
        $(".delete_article").each(function () {
          $(this).modalForm({formURL: $(this).data('id')});
        });

      });
    </script>
{% endblock %}