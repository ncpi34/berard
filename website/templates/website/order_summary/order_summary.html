{% extends 'website/base.html' %}

{% load static %}

{% block navbar %}
    {% include 'website/sidenav.html' %}
{% endblock %}


{% block content %}
    <main>
    <div class="container" >
    <div class="table-responsive text-center" style="min-height: 83vh">
    <h2 id="title_page" class="text-center mt-4 mb-5">Historique commandes</h2>
    {% if histories %}
    <table class="table">
        <thead>
        <tr>

            <th scope="col">Date</th>
            <th scope="col">Nombre de produits</th>
            <th scope="col">Total</th>
        </tr>
        </thead>
        <tbody>

        {% for history in histories %}

        <tr>

            <th>
                <a style="color:blue" href="{{ history.get_absolute_url }}">
                {{ history.date }}
                </a>
            </th>
            <td>{{ history.get_number_products|title }}</td>
            <td class="num">{{ history.get_total_cost }}â‚¬</td>

        </tr>
        {% endfor %}

        </tbody>
    </table>
        <p class="text-right">
            <a href="{% url 'website:products' %}">
                <button class="btn btn-success">Retourner aux produits</button>
            </a>
        </p>

{% else %}
         <div class="container text-center mt-5" style="min-height: 80vh">
            <h3 style="margin-bottom: 50vh">Votre historique de commande est vide ...</h3>

        <p class="text-right">
            <a href="{% url 'website:products' %}">
                <button  id="btn_return" class="btn btn-success">Retourner aux produits</button>
            </a>
        </p>
        </div>

{% endif %}
    </div>
    </div>
  </main>
{% endblock %}

{% block extrascripts %}


    <script>
    let widthScreenStart = window.innerWidth;
    const btn = document.querySelector('#btn_return')

    if (widthScreenStart < 752) {
                title.innerHTML = 'Historique'
            } else {
                title.innerHTML = 'Historique commandes'
            }
    if (btn) {
            if (widthScreenStart < 445) {
                btn.innerHTML = 'RETOUR'
            } else {
                btn.innerHTML = 'RETOUR AUX PRODUITS'
            }
        }
    // calculate screen windows in real time and change html
    function resize() {
        let widthScreenReload = window.innerWidth;
        const title = document.querySelector('#title_page')
        if (widthScreenReload < 752) {
                title.innerHTML = 'Historique'
            } else {
                title.innerHTML = 'Historique commandes'
            }


        if (btn) {
            if (widthScreenReload < 445) {
                btn.innerHTML = 'RETOUR'
            } else {
                btn.innerHTML = 'RETOUR AUX PRODUITS'
            }
        }

    }
    window.onresize = resize;
    </script>
{% endblock %}